<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Noise Generator</title>
  <link rel="stylesheet" href="./lib/styles.css">
</head>
<body>
  <h1><span id="home" title="zurÃ¼ck zu QuickFill" class="icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
  </svg></span>Noise Generator</h1>

  <button id="start">Start</button>
  <button id="stopp">Stopp</button>
  
  
  <script>
    const DarkMode = localStorage.getItem('DarkMode') === 'true';
    if ( DarkMode ) document.body.classList.add('dark-mode');

    const home =  document.getElementById('home');
    home.addEventListener('click', event => {
      window.location.assign("./index.html");
    });

    const start = document.getElementById('start');
    const stopp = document.getElementById('stopp');

    let audioContext, brownNoiseNode;

    start.addEventListener('click', async event => {
      audioContext = new AudioContext();
      await audioContext.audioWorklet.addModule('./lib/brown-noise-processor.js');
      brownNoiseNode = new AudioWorkletNode(audioContext, 'brown-noise', { gain: 0.5 });
      brownNoiseNode.connect(audioContext.destination);
    });

    stopp.addEventListener('click', async event => {
      await brownNoiseNode?.disconnect(audioContext?.destination);
      await audioContext?.close();
      audioContext = null;
      brownNoiseNode = null;
    });
    
  </script>
</body>
</html>